<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Rick & Morty</title>

    <!-- Bootstrap -->
    <link
      href="/CONSUMO DE API FILTROS, LOCALSTORAGE, DIRECTIVAS/Css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- CSS -->
    <link
      rel="stylesheet"
      href="/CONSUMO DE API FILTROS, LOCALSTORAGE, DIRECTIVAS/Css/estilos.css"
    />

    <!-- Vue 3 -->
    <script src="/CONSUMO DE API FILTROS, LOCALSTORAGE, DIRECTIVAS/js/vue3.js"></script>
  </head>
  <body>
    <div id="app" class="container py-4">
      <!-- ================= FAVORITOS ================= -->
      <div class="favoritos-container mb-4">
        <div class="d-flex justify-content-between align-items-center">
          <h4 class="titulo-favoritos">Favoritos ({{ favoritos.length }})</h4>

          <button
            class="btn btn-primary"
            @click="mostrarFavoritos = !mostrarFavoritos"
          >
            {{ mostrarFavoritos ? 'Ocultar' : 'Mostrar' }}
          </button>
        </div>

        <div v-show="mostrarFavoritos" class="mt-3">
          <div v-if="favoritos.length === 0" class="alert alert-info">
            No hay personajes en favoritos
          </div>

          <div
            v-for="fav in favoritos"
            :key="fav.id"
            class="carrito-item d-flex justify-content-between align-items-center"
          >
            <span>{{ fav.name }}</span>

            <button
              class="btn btn-danger btn-sm"
              @click="eliminarFavorito(fav.id)"
            >
              X
            </button>
          </div>

          <div v-if="favoritos.length > 0" class="mt-3">
            <button class="btn btn-warning w-100" @click="vaciarFavoritos">
              Vaciar favoritos
            </button>
          </div>
        </div>
      </div>

      <!-- ================= TITULO ================= -->
      <h1 class="text-center mb-4 titulo-principal">Catálogo Rick & Morty</h1>

      <!-- ================= FILTROS ================= -->
      <div class="row mb-4">
        <div class="col-md-4">
          <input
            type="text"
            class="form-control"
            placeholder="Buscar por nombre"
            v-model="busqueda"
          />
        </div>

        <div class="col-md-4">
          <select class="form-select" v-model="filtroEstado">
            <option value="">Todos los estados</option>
            <option value="Alive">Vivo</option>
            <option value="Dead">Muerto</option>
            <option value="unknown">Desconocido</option>
          </select>
        </div>

        <div class="col-md-4">
          <select class="form-select" v-model="filtroGenero">
            <option value="">Todos los géneros</option>
            <option value="Male">Masculino</option>
            <option value="Female">Femenino</option>
            <option value="Genderless">Sin género</option>
            <option value="unknown">Desconocido</option>
          </select>
        </div>
      </div>

      <!-- ================= CONTADOR ================= -->
      <div class="mb-2">
        <strong>Total encontrados:</strong>
        {{ personajesFiltrados.length }}
      </div>

      <!-- ================= BARRA PROGRESO ================= -->
      <div class="progress mb-4">
        <div
          class="progress-bar"
          role="progressbar"
          :style="{ width: porcentaje + '%' }"
        >
          {{ porcentaje }}%
        </div>
      </div>

      <!-- ================= TARJETAS ================= -->
      <div class="row">
        <div
          class="col-lg-3 col-md-4 col-sm-6 mb-4"
          v-for="personaje in personajesFiltrados"
          :key="personaje.id"
        >
          <div class="card tarjeta-custom h-100">
            <img :src="personaje.image" class="card-img-top" />

            <div class="card-body">
              <h5 class="card-title">{{ personaje.name }}</h5>

              <p class="card-text">
                Estado:
                <span :class="claseEstado(personaje.status)">
                  {{ personaje.status }}
                </span>
              </p>

              <button
                class="btn btn-primary btn-sm me-2"
                @click="mostrarDetalle(personaje)"
              >
                Ver detalle
              </button>

              <button
                class="btn btn-warning btn-sm"
                @click="agregarFavorito(personaje)"
              >
                Favorito
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- ================= MODAL ================= -->
      <div
        v-if="personajeSeleccionado"
        class="modal fade show"
        style="display: block; background: rgba(0, 0, 0, 0.7)"
      >
        <div class="modal-dialog">
          <div class="modal-content modal-custom">
            <div class="modal-header">
              <h5 class="modal-title">{{ personajeSeleccionado.name }}</h5>
              <button
                type="button"
                class="btn-close"
                @click="personajeSeleccionado = null"
              ></button>
            </div>

            <div class="modal-body text-center">
              <img :src="personajeSeleccionado.image" class="img-fluid mb-3" />

              <p>
                <strong>Especie:</strong> {{ personajeSeleccionado.species }}
              </p>
              <p><strong>Género:</strong> {{ personajeSeleccionado.gender }}</p>
              <p>
                <strong>Origen:</strong> {{ personajeSeleccionado.origin.name }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JS -->
    <script src="/CONSUMO DE API FILTROS, LOCALSTORAGE, DIRECTIVAS/js/funciones.js"></script>
  </body>
</html>
